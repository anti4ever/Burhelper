<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Расчеты в бурении</title>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- My styles -->
    <link href="style.css" rel="stylesheet">
    <!-- Подключение Animate.css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet">
    <link href="jquery-ui.css" rel="stylesheet">
    <!-- jQuery JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    <!-- jQuery UI для плагина Autocomlete -->
    <script src="jquery-ui.js"></script>
    <script src="jquery.ui.autocomplete.scroll.min.js"></script>
    <!-- MathJax для отображения формул -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} });
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <!-- Bootstrap JS -->
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    <!-- Работа с числами с плавающей точкой Big.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/big.js/4.0.2/big.min.js"></script>
    <!-- Подключение Vue.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.4/vue.js"></script>
    <!-- Подключение иконки -->
    <link rel="shortcut icon" href="favicon.png" type="image/png">
</head>

<body>
    <br>
    <div class="container" id="mainapp">
        <!--Изменение максимальной ширины на 450px (стандартно 750px) через класс "container"-->
        <!-- Заголовок -->
        <div class="well well-sm text-center">
            <img src="favicon.png" class="mainimg">
            <b>
                <br>
                <a href="#">Burhelper.ru</a>
            </b>
            <h2>Расчеты в бурении</h2>
            <small>Мини утилиты на каждый день.</small>
            <br>
        </div>
        <!-- Кнопка На главную страницу -->
        <transition enter-active-class="animated fadeIn" leave-active-class="animated fadeOut" v-on:after-enter="seenmodulecase = !seenmodulecase"
            v-on:after-leave="seenmodulesbtn=!seenmodulesbtn">
            <div class="well well-sm" v-show="seenmainbtn" style="animation-duration: 350ms">
                <button v-on:click="seenfooter=!seenfooter" class="btn btn-primary btn-block">На главную страницу</button>
            </div>
        </transition>
        <!-- Кнопки модулей -->
        <transition enter-active-class="animated fadeIn" leave-active-class="animated fadeOut" v-on:after-leave="seenmainbtn=!seenmainbtn"
            v-on:after-enter="seenfooter=!seenfooter">
            <div v-show="seenmodulesbtn" class="buttoncase well well-sm text-center" style="animation-duration: 350ms">
                <button v-on:click="getmodule(value.dir)" v-for="value in modulesinfo" :dir="value.dir" :title="value.description" class="btn btn-primary btn-block"
                    style="white-space: normal">{{value.name}}</button>
            </div>
        </transition>
        <!-- Кейс модуля -->
        <transition enter-active-class="animated fadeIn" leave-active-class="animated fadeOut" v-on:after-leave="seenmainbtn = !seenmainbtn"
            v-on:after-enter="seenfooter = !seenfooter">
            <div v-show="seenmodulecase" class="modulecase well well-sm" style="animation-duration: 350ms"></div>
        </transition>
        <!-- Подвал -->
        <transition enter-active-class="animated fadeIn" leave-active-class="animated fadeOut" v-on:after-leave="backonmain">
            <div v-show="seenfooter" class="well well-sm text-center" style="animation-duration: 350ms">
                <p>
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color: red;"></span> Нашли ошибку:
                    <a href="mailto:burhelper@mail.ru">burhelper@mail.ru</a>
                </p>
                <p>
                    <span class="glyphicon glyphicon-modal-window" aria-hidden="true"></span> Есть предложения по новым
                    <br>модулям:
                    <a href="mailto:burhelper@mail.ru">burhelper@mail.ru</a>
                </p>
                <p>
                    <small>Cоздано с помощью:
                        <br>
                        <a href="http://getbootstrap.com">Bootstrap</a> ,
                        <a href="http://jquery.com/">jQuerty</a> ,
                        <a href="http://jqueryui.com/">jQuery UI</a> ,
                        <a href="https://github.com/MikeMcl/big.js">Big.js</a>
                        ,
                        <a href="https://daneden.github.io/animate.css/">Animate.css</a> ,
                        <a href="https://vuejs.org">Vue.js</a> ,
                        <a href="https://www.mathjax.org">MathJax.</a>
                    </small>
                </p>
            </div>
        </transition>
    </div>
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function (d, w, c) {
            (w[c] = w[c] || []).push(function () {
                try {
                    w.yaCounter44423974 = new Ya.Metrika({
                        id: 44423974,
                        clickmap: true,
                        trackLinks: true,
                        accurateTrackBounce: true
                    });
                } catch (e) {}
            });

            var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () {
                    n.parentNode.insertBefore(s, n);
                };
            s.type = "text/javascript";
            s.async = true;
            s.src = "https://mc.yandex.ru/metrika/watch.js";

            if (w.opera == "[object Opera]") {
                d.addEventListener("DOMContentLoaded", f, false);
            } else {
                f();
            }
        })(document, window, "yandex_metrika_callbacks");
    </script>
    <noscript>
        <div>
            <img src="https://mc.yandex.ru/watch/44423974" style="position:absolute; left:-9999px;" alt="" />
        </div>
    </noscript>
    <!-- /Yandex.Metrika counter -->

    <!-- Создание приложения на Vue.js -->
    <script>
        // Создание основного экземпляра (главного приложения) Vue c именем "vm" с привязкой к id "maimapp"
        var vm = new Vue({
            el: "#mainapp",
            data: {
                modulesinfo: Object,
                dir: String,
                moduletrigger: true,
                seenmainbtn: false,
                seenmodulesbtn: true,
                seenmodulecase: false,
                seenfooter: true
            },
            methods: {
                getmodule: function (dir) {
                    if (this.moduletrigger == true) {
                        $(".modulecase").load(dir);
                        this.moduletrigger = false;
                        this.animateloadmodule();
                    } else {
                        $(".modulecase").load(dir);
                        this.animateloadmodule();
                    };
                },
                backonmain: function () {
                    if (this.seenmodulesbtn == true) {
                        this.seenmodulesbtn = false;
                    }
                    if (this.seenmodulecase == true) {
                        this.seenmodulecase = false;
                        module.$destroy();
                        //console.log("dest");
                    };
                },
                animateloadmodule: function () {
                    this.seenfooter = !this.seenfooter;
                }
            },
            mounted: function () {
                $.getJSON("modules.json", function (data) { // Загрузка modules.json
                    vm.modulesinfo = data;
                    //console.log(vm.modulesinfo);
                })
            }
        });
        //---Глобальное переназначение регулярного выражения поиска плагина jquery ui.autocomlete
        var escapeRegexp = $.ui.autocomplete.escapeRegex;
        $.extend($.ui.autocomplete, {
            escapeRegex: function (value) {
                return '^' + escapeRegexp(value);
            }
        });
        //--------------------------------------------------------------------------------------
    </script>
</body>

</html>